<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfilZeichner</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-sans h-screen overflow-hidden">
    <div class="flex h-screen">
        <!-- Hauptbereich -->
        <div class="flex-1 flex flex-col">
            <!-- Men√ºleiste -->
            <div class="bg-white px-5 py-4 flex items-center gap-5 shadow-md border-b border-gray-200">
            <!-- Logo -->
                <div class="flex items-center mr-4">
                    <svg class="h-20 w-auto max-w-[400px]" viewBox="0 0 200 60" xmlns="http://www.w3.org/2000/svg">
                        <!-- Hintergrund -->
                        <rect width="200" height="60" fill="#f8f9fa" rx="4"/>
                        
                        <!-- Profil-Illustration -->
                        <rect x="20" y="20" width="60" height="20" fill="none" stroke="#333" stroke-width="2"/>
                        <rect x="22" y="22" width="56" height="16" fill="#e0e0e0"/>
                        
                        <!-- Bema√üungspfeile -->
                        <line x1="20" y1="45" x2="20" y2="50" stroke="#0066cc" stroke-width="1.5"/>
                        <line x1="80" y1="45" x2="80" y2="50" stroke="#0066cc" stroke-width="1.5"/>
                        <line x1="20" y1="47.5" x2="80" y2="47.5" stroke="#0066cc" stroke-width="1.5"/>
                        <path d="M 20 47.5 L 24 45 L 24 50 Z" fill="#0066cc"/>
                        <path d="M 80 47.5 L 76 45 L 76 50 Z" fill="#0066cc"/>
                        
                        <!-- Text -->
                        <text x="100" y="35" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Profil</text>
                        <text x="100" y="50" font-family="Arial, sans-serif" font-size="14" fill="#666">Zeichner</text>
                    </svg>
                </div>
                
                <div class="flex items-center gap-2">
                    <label for="width-input" class="font-semibold text-gray-700 text-sm">Breite:</label>
                    <input type="number" id="width-input" placeholder="Breite eingeben" min="1" value="100" class="px-3 py-1.5 border-2 border-gray-200 rounded-lg text-sm w-24 bg-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors">
                    <span class="text-gray-600 text-sm">mm</span>
                </div>
                <div class="flex items-center gap-2">
                    <label for="height-input" class="font-semibold text-gray-700 text-sm">H√∂he:</label>
                    <input type="number" id="height-input" placeholder="H√∂he eingeben" min="1" value="20" class="px-3 py-1.5 border-2 border-gray-200 rounded-lg text-sm w-24 bg-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors">
                    <span class="text-gray-600 text-sm">mm</span>
                </div>
                <div class="flex items-center gap-2">
                    <button id="draw-button" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-semibold" title="Profil zeichnen - Rechteck mit angegebenen Ma√üen erstellen">‚úì</button>
                </div>
                <div class="flex items-center gap-2">
                    <button id="clear-button" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-semibold" title="Alles l√∂schen - Zeichnung zur√ºcksetzen">‚úï</button>
                </div>
                <div class="flex items-center gap-2">
                    <button id="undo-button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-semibold" title="R√ºckg√§ngig - Letzte Aktion r√ºckg√§ngig machen">‚Ü∂</button>
                </div>
                <div class="flex items-center gap-2">
                    <button id="redo-button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-semibold" title="Wiederholen - Letzte Aktion wiederholen">‚Ü∑</button>
                </div>
                
                <div class="flex items-center gap-2 ml-auto">
                    <label for="zoom-slider" class="font-semibold text-gray-700 text-sm">Zoom:</label>
                    <input type="range" id="zoom-slider" min="10" max="500" value="100" step="5" class="w-40">
                    <span id="zoom-level" class="ml-2 min-w-[50px] inline-block text-sm text-gray-700">100%</span>
                </div>
            </div>
            
            <!-- Canvas Container -->
            <div class="flex-1 relative bg-white overflow-hidden">
                <canvas id="main-canvas" class="absolute inset-0"></canvas>
                
                <!-- Canvas Overlay Buttons (rechts) -->
                <div class="absolute top-4 right-4 flex flex-col gap-2 z-10">
                    <button id="bohne-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Bohne hinzuf√ºgen - Ein rundes Element oben am Profil">‚óè</button>
                    <button id="cutout-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Cut out - Profileck abtrennen">‚îî</button>
                    <button id="kerbe-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Kerbe hinzuf√ºgen - Ein dreieckiger Einschnitt">‚ó¢</button>
                    <button id="nahtlinie-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Nahtlinie einzeichnen - Gestrichelte Linie">‚îÅ</button>
                    <button id="loch-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Loch hinzuf√ºgen - Ein rundes oder ovales Loch">‚óã</button>
                    <button id="ausschnitt-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Ausschnitt erstellen - Ein rechteckiger Ausschnitt">‚ñ¢</button>
                    <button id="crimping-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Crimping - Materialumklappung (noch nicht verf√ºgbar)">‚óà</button>
                    <button id="bema√üung-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Bema√üung ein-/ausblenden - Technische Ma√üangaben">üìè</button>
                    <button id="text-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg font-bold" title="Text hinzuf√ºgen - Textfeld auf die Zeichnung">T</button>
                    <button id="bild-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Bild einf√ºgen - Bild vom Rechner auf das Canvas laden">üñºÔ∏è</button>
                    <button id="database-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Profil-Datenbank √∂ffnen - Profile verwalten">üìÅ</button>
                    <button id="zeichnungsdb-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Zeichnungen √∂ffnen - Fertige Zeichnungen verwalten">üìã</button>
                    <button id="titleblock-button" class="w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:bg-gray-50 hover:shadow-lg transition-all flex items-center justify-center text-lg" title="Titelblock anzeigen/bearbeiten">üè∑Ô∏è</button>
                </div>
                
                <!-- Untere Button-Leiste -->
                <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg shadow-lg border border-gray-200 z-10">
                    <button id="auto-zoom-button" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium" title="Automatisch zoomen - Gesamte Zeichnung anzeigen">üîç</button>
                    <button id="pan-button" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium" title="Alles verschieben - Per Mausklick und Drag">‚úã</button>
                    <button id="pdf-button" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium" title="Als PDF exportieren - Speichern als PDF-Datei">üìÑ</button>
                    <button id="svg-button" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium" title="Als SVG exportieren - Vektorgrafik exportieren">SVG</button>
                    <button id="dxf-button" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium" title="Als DXF exportieren - CAD-Geometrie exportieren">DXF</button>
                    <button id="einstellungen-button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm font-medium" title="Einstellungen - Bema√üungen und Titelblock anpassen">‚öôÔ∏è</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Titelblock Modal -->
    <div id="titleblock-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Titelblock</h3>
                <button id="titleblock-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Projekt</label>
                        <input type="text" id="tb-project" placeholder="Projekt" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Variante</label>
                        <input type="text" id="tb-variant" placeholder="Variante" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Bez√ºgenummer</label>
                        <input type="text" id="tb-reference" placeholder="Bez√ºgenummer" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Zeichnungsnummer</label>
                        <input type="text" id="tb-zeichnungsnummer" placeholder="Zeichnungsnummer" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Revision</label>
                        <input type="text" id="tb-revision" placeholder="Revision" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">SPS Nummer</label>
                        <input type="text" id="tb-spsnummer" placeholder="SPS Nummer" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Material</label>
                        <input type="text" id="tb-material" placeholder="Material" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Lieferantennummer</label>
                        <input type="text" id="tb-supplier" placeholder="Lieferantennr." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Datum</label>
                        <input type="date" id="tb-date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="flex gap-2 mt-4">
                    <button id="tb-fill-from-db" class="px-4 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="Aus DB √ºbernehmen">‚Üª</button>
                    <button id="tb-save-to-db" class="px-4 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="In DB speichern">üíæ</button>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="titleblock-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="titleblock-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="√úbernehmen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Email Confirmation Modal -->
    <div id="email-confirmation-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">E-Mail vorbereitet</h3>
                <button id="email-confirmation-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <p class="mb-4">Ihre E-Mail wurde vorbereitet! SVG- und PDF-Dateien werden als Anh√§nge vorbereitet.</p>
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <h4 class="font-semibold mb-2">N√§chste Schritte:</h4>
                    <ol class="list-decimal list-inside space-y-1 text-sm">
                        <li>Klicken Sie auf "SVG & PDF herunterladen & E-Mail √∂ffnen"</li>
                        <li>SVG- und PDF-Dateien werden automatisch heruntergeladen</li>
                        <li>Ihr E-Mail-Programm √∂ffnet sich mit vorausgef√ºlltem Text</li>
                        <li>F√ºgen Sie beide Dateien (SVG + PDF) als Anh√§nge in die E-Mail ein</li>
                        <li>Versenden Sie die E-Mail an den Dienstleister</li>
                    </ol>
                    <div class="mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800">
                        <strong>Hinweis:</strong> Die Dateien werden in Ihren Download-Ordner gespeichert. Bitte f√ºgen Sie sie manuell als Anh√§nge in die E-Mail ein.
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">E-Mail-Text (Vorschau):</label>
                    <textarea id="email-text-preview" readonly class="w-full h-48 px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs resize-y"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">E-Mail-Adresse des Dienstleisters:</label>
                    <input type="email" id="freelancer-email" placeholder="freelancer@example.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="email-confirmation-close2" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Schlie√üen">‚úï</button>
                <!-- Button f√ºr Order-Funktion (Version 2.0) - aktuell deaktiviert -->
                <button class="px-4 py-2 bg-gray-400 text-white rounded-lg cursor-not-allowed opacity-50" title="Wird in Version 2.0 verf√ºgbar sein" disabled>
                    üìß SVG & PDF herunterladen & E-Mail √∂ffnen
                </button>
            </div>
        </div>
    </div>

    <!-- Einstellungen Modal -->
    <div id="einstellungen-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Einstellungen</h3>
                <button id="einstellungen-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Textgr√∂√üe f√ºr Bema√üungen (px)</label>
                        <input type="number" id="settings-dimension-font-size" min="8" max="24" step="1" placeholder="12" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-xs text-gray-600 mt-1 block">Aktuell: <span id="settings-dimension-font-size-current">12px</span></span>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Titelblock - Breite (mm)</label>
                        <input type="number" id="settings-titleblock-width" min="60" max="150" step="5" placeholder="90" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-xs text-gray-600 mt-1 block">Aktuell: <span id="settings-titleblock-width-current">90mm</span></span>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Titelblock - H√∂he (mm)</label>
                        <input type="number" id="settings-titleblock-height" min="30" max="80" step="5" placeholder="40" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-xs text-gray-600 mt-1 block">Aktuell: <span id="settings-titleblock-height-current">40mm</span></span>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="einstellungen-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="einstellungen-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="√úbernehmen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Zeichnungen Modal -->
    <div id="zeichnungsdb-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-[90%] max-w-6xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Zeichnungen</h3>
                <div class="flex gap-2">
                    <button id="zeichnungsdb-modal-minimize" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm" title="Minimieren">‚àí</button>
                    <button id="zeichnungsdb-modal-maximize" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm" title="Maximieren">‚ñ°</button>
                    <button id="zeichnungsdb-modal-close" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm" title="Schlie√üen">&times;</button>
                </div>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="flex justify-between items-center mb-4 gap-2">
                    <div class="flex gap-2">
                        <button id="zeichnungsdb-add-project" class="px-3 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="Projekt hinzuf√ºgen" aria-label="Projekt hinzuf√ºgen">‚ûï</button>
                        <button id="zeichnungsdb-add-variant" class="px-3 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="Variante hinzuf√ºgen" aria-label="Variante hinzuf√ºgen">‚ûï</button>
                        <button id="zeichnungsdb-save-current" class="px-3 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="Aktuelle Zeichnung speichern" aria-label="Speichern">üíæ</button>
                    </div>
                    <div class="flex gap-2">
                        <button id="zeichnungsdb-open-file" class="px-3 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="Zeichnungen laden" aria-label="√ñffnen">üìÇ</button>
                        <button id="zeichnungsdb-save-file" class="px-3 py-2 bg-gray-100 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" title="Zeichnungen speichern" aria-label="Speichern">üíæ</button>
                        <input type="file" id="zeichnungsdb-file-input" accept=".json" class="hidden" />
                    </div>
                </div>
                <!-- Datei-Info f√ºr Zeichnungen-Datenbank -->
                <div class="px-3 py-2 bg-gray-50 rounded mb-4 text-sm text-gray-600">
                    <span id="zeichnungsdb-file-info">Keine Datei geladen</span>
                </div>
                <div class="grid grid-cols-[200px_200px_200px_1fr] gap-3 min-h-[420px]">
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-2 flex flex-col">
                        <div class="text-xs font-semibold text-gray-700 uppercase mb-2">Projekte</div>
                        <ul id="zeichnungsdb-project-list" class="flex-1 overflow-y-auto space-y-1"></ul>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-2 flex flex-col">
                        <div class="text-xs font-semibold text-gray-700 uppercase mb-2">Varianten</div>
                        <ul id="zeichnungsdb-variant-list" class="flex-1 overflow-y-auto space-y-1"></ul>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-2 flex flex-col">
                        <div class="text-xs font-semibold text-gray-700 uppercase mb-2">Bez√ºgenummern</div>
                        <div class="flex gap-1 mb-2">
                            <input type="text" id="zeichnungsdb-ref-input" placeholder="Bez√ºgenummer..." class="flex-1 px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <button id="zeichnungsdb-add-ref" class="px-2 py-1 bg-gray-100 border border-gray-300 text-gray-700 rounded hover:bg-gray-200 transition-colors text-xs" title="Bez√ºgenummer hinzuf√ºgen" aria-label="Bez√ºgenummer hinzuf√ºgen">‚ûï</button>
                        </div>
                        <ul id="zeichnungsdb-ref-list" class="flex-1 overflow-y-auto space-y-1"></ul>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-2 flex flex-col">
                        <div class="text-xs font-semibold text-gray-700 uppercase mb-2">Profile</div>
                        <div id="zeichnungsdb-profile-grid" class="flex-1 overflow-y-auto grid grid-cols-[repeat(auto-fill,minmax(140px,1fr))] gap-2"></div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="zeichnungsdb-close" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Schlie√üen">‚úï</button>
        </div>
        </div>
    </div>

    <!-- Bohne Modal -->
    <div id="bohne-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Bohne hinzuf√ºgen</h3>
                <button id="bohne-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-4">
                    <label for="bohne-height" class="block text-sm font-medium text-gray-700 mb-2">H√∂he der Bohne:</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="bohne-height" placeholder="H√∂he eingeben" min="1" value="4" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-600">mm</span>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="bohne-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="bohne-remove" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors" title="Entfernen">üóëÔ∏è</button>
                <button id="bohne-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Cut out Modal -->
    <div id="cutout-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Cut out hinzuf√ºgen</h3>
                <button id="cutout-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-4">
                    <label for="cutout-width" class="block text-sm font-medium text-gray-700 mb-2">Breite:</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="cutout-width" placeholder="Breite eingeben" min="1" value="20" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-600">mm</span>
                    </div>
                </div>
                <div class="mb-4">
                    <label for="cutout-height" class="block text-sm font-medium text-gray-700 mb-2">H√∂he:</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="cutout-height" placeholder="H√∂he eingeben" min="1" value="10" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-600">mm</span>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="cutout-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="cutout-remove" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors" title="Entfernen">üóëÔ∏è</button>
                <button id="cutout-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Kerbe Modal -->
    <div id="kerbe-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Kerben hinzuf√ºgen</h3>
                <button id="kerbe-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-4">
                    <button id="open-kerben-types-modal-btn" class="w-auto px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors mb-2">‚öôÔ∏è Kerben-Typen verwalten</button>
                </div>
                
                <div class="border border-gray-200 rounded-lg overflow-hidden mb-4">
                    <div class="max-h-96 overflow-y-auto">
                        <table id="kerbe-table" class="w-full border-collapse">
                            <thead class="bg-gray-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Kerben-Typ</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Abstand (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Position</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Aktion</th>
                            </tr>
                        </thead>
                            <tbody id="kerbe-tbody" class="bg-white">
                            <!-- Kerben werden hier dynamisch hinzugef√ºgt -->
                        </tbody>
                    </table>
                    </div>
                    <div class="p-4 bg-gray-50 border-t border-gray-200">
                        <button id="add-kerbe-btn" class="w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">+ Kerbe hinzuf√ºgen</button>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="kerbe-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="kerbe-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Kerben-Typen Verwaltungs-Modal -->
    <div id="kerben-types-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Kerben-Typen verwalten</h3>
                <button id="kerben-types-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-5">
                    <div id="kerben-types-list" class="mb-3">
                        <!-- Kerben-Typen werden hier dynamisch hinzugef√ºgt -->
                    </div>
                    <button id="add-kerben-type-btn" class="w-auto px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">+ Neuer Kerben-Typ</button>
                    <div class="mt-2 text-xs text-gray-600">Maximal 3 Kerben-Typen m√∂glich</div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="kerben-types-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Schlie√üen">‚úï</button>
                <button id="kerben-types-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="√úbernehmen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Nahtlinie Modal -->
    <div id="nahtlinie-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Nahtlinie hinzuf√ºgen</h3>
                <button id="nahtlinie-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-4">
                    <label for="nahtlinie-distance" class="block text-sm font-medium text-gray-700 mb-2">Abstand von unten:</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="nahtlinie-distance" placeholder="Abstand eingeben" min="1" step="0.1" value="8" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-600">mm</span>
                    </div>
                </div>
                <div class="mb-4">
                    <label for="nahtlinie-type" class="block text-sm font-medium text-gray-700 mb-2">Linientyp:</label>
                    <select id="nahtlinie-type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="dashed">Gestrichelt</option>
                        <option value="holes">Mit L√∂chern (1mm)</option>
                    </select>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="nahtlinie-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="nahtlinie-remove" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors" title="Entfernen">üóëÔ∏è</button>
                <button id="nahtlinie-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
        </div>
    </div>
    </div>

    <!-- Loch Modal -->
    <div id="loch-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">L√∂cher hinzuf√ºgen</h3>
                <button id="loch-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-6 space-y-4">
                    <div>
                        <label for="loch-width" class="block text-sm font-medium text-gray-700 mb-2">Breite:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="loch-width" placeholder="Breite eingeben" min="1" step="0.1" value="8" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <span class="text-gray-600">mm</span>
                        </div>
                    </div>
                    <div>
                        <label for="loch-height" class="block text-sm font-medium text-gray-700 mb-2">H√∂he:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="loch-height" placeholder="H√∂he eingeben" min="1" step="0.1" value="4" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <span class="text-gray-600">mm</span>
                        </div>
                    </div>
                    <div>
                        <label for="loch-position" class="block text-sm font-medium text-gray-700 mb-2">Position von oben:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="loch-position" placeholder="Abstand von oben" min="0" step="0.1" value="2" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <span class="text-gray-600">mm</span>
                        </div>
                    </div>
                    <div id="loch-kerben-checkbox-group" class="hidden">
                        <label class="flex items-center gap-2">
                            <input type="checkbox" id="loch-use-kerben-positions" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                            <span class="text-sm text-gray-700">Positionen von Kerben √ºbernehmen</span>
                        </label>
                    </div>
                </div>
                
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="max-h-96 overflow-y-auto">
                        <table id="loch-table" class="w-full border-collapse">
                            <thead class="bg-gray-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Abstand von links (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Aktion</th>
                            </tr>
                        </thead>
                            <tbody id="loch-tbody" class="bg-white">
                        </tbody>
                    </table>
                    </div>
                    <div class="p-4 bg-gray-50 border-t border-gray-200">
                        <button id="add-loch-btn" class="w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">Loch hinzuf√ºgen</button>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="loch-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="loch-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>
    
    <!-- Text Modal -->
    <div id="text-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Text hinzuf√ºgen</h3>
                <button id="text-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <div class="mb-4">
                    <label for="text-content" class="block text-sm font-medium text-gray-700 mb-2">Text:</label>
                    <input type="text" id="text-content" placeholder="Text eingeben" maxlength="50" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="mb-4">
                    <label for="text-size" class="block text-sm font-medium text-gray-700 mb-2">Schriftgr√∂√üe:</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="text-size" placeholder="Schriftgr√∂√üe" min="8" max="48" value="16" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-600">px</span>
                </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="text-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="text-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Ausschnitt Modal -->
    <div id="ausschnitt-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Ausschnitt hinzuf√ºgen</h3>
                <button id="ausschnitt-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <p class="mb-4 text-gray-600 text-sm">
                    F√ºgen Sie Ausschnitte hinzu, die das Profil durchschneiden. Position = Abstand vom linken Rand, 
                    L√§nge = Breite des Ausschnitts, H√∂he = Tiefe des Ausschnitts.
                </p>
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="max-h-96 overflow-y-auto">
                        <table id="ausschnitt-table" class="w-full border-collapse">
                            <thead class="bg-gray-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Position (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">L√§nge (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">H√∂he (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Position</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Aktion</th>
                            </tr>
                        </thead>
                            <tbody id="ausschnitt-tbody" class="bg-white">
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-height-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3">
                                        <select class="ausschnitt-position-select w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="oben">Oben</option>
                                        <option value="unten">Unten</option>
                                    </select>
                                </td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeAusschnittRow(this)">‚úï</button></td>
                            </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-height-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3">
                                        <select class="ausschnitt-position-select w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="oben">Oben</option>
                                        <option value="unten">Unten</option>
                                    </select>
                                </td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeAusschnittRow(this)">‚úï</button></td>
                            </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-height-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3">
                                        <select class="ausschnitt-position-select w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="oben">Oben</option>
                                        <option value="unten">Unten</option>
                                    </select>
                                </td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeAusschnittRow(this)">‚úï</button></td>
                            </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="ausschnitt-height-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3">
                                        <select class="ausschnitt-position-select w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="oben">Oben</option>
                                        <option value="unten">Unten</option>
                                    </select>
                                </td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeAusschnittRow(this)">‚úï</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="p-4 bg-gray-50 border-t border-gray-200">
                        <button id="add-ausschnitt-row" class="w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">+</button>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="ausschnitt-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="ausschnitt-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Crimping Modal -->
    <div id="crimping-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Crimping hinzuf√ºgen</h3>
                <button id="crimping-modal-close" class="bg-red-500 text-white border-none w-8 h-8 rounded flex items-center justify-center font-bold hover:bg-red-600 transition-colors">&times;</button>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <p class="mb-4 text-gray-600 text-sm">
                    F√ºgen Sie Crimping-Bereiche hinzu, die in der Bohne platziert werden. Position = Abstand vom linken Rand der Bohne, 
                    L√§nge = Breite des Crimping-Bereichs. Die H√∂he entspricht automatisch der H√∂he der Bohne.
                </p>
                <div id="crimping-no-bohne-warning" class="hidden p-4 bg-yellow-50 border border-yellow-200 rounded-lg mb-4 text-yellow-800">
                    ‚ö†Ô∏è Es ist keine Bohne vorhanden. Bitte erstellen Sie zuerst eine Bohne, bevor Sie Crimping hinzuf√ºgen k√∂nnen.
                </div>
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="max-h-96 overflow-y-auto">
                        <table id="crimping-table" class="w-full border-collapse">
                            <thead class="bg-gray-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Position (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">L√§nge (mm)</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b border-gray-200">Aktion</th>
                                </tr>
                            </thead>
                            <tbody id="crimping-tbody" class="bg-white">
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="crimping-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="crimping-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeCrimpingRow(this)">‚úï</button></td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="crimping-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="crimping-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeCrimpingRow(this)">‚úï</button></td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="px-4 py-3"><input type="number" class="crimping-position-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><input type="number" class="crimping-length-input w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="0" step="0.1"></td>
                                    <td class="px-4 py-3"><button class="remove-row-btn px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors" onclick="removeCrimpingRow(this)">‚úï</button></td>
                            </tr>
                        </tbody>
                    </table>
                    </div>
                    <div class="p-4 bg-gray-50 border-t border-gray-200">
                        <button id="add-crimping-row" class="w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">+</button>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="crimping-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Abbrechen">‚úï</button>
                <button id="crimping-confirm" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Best√§tigen">‚úì</button>
            </div>
        </div>
    </div>

    <!-- Profil-Datenbank Modal -->
    <div id="database-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-[90%] max-w-6xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="bg-gray-100 px-6 py-5 flex justify-between items-center border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-800">Profil-Datenbank</h3>
                <div class="flex gap-2">
                    <button id="database-modal-minimize" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm" title="Minimieren">‚àí</button>
                    <button id="database-modal-maximize" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm" title="Maximieren">‚ñ°</button>
                    <button id="database-modal-close" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm" title="Schlie√üen">&times;</button>
                </div>
            </div>
            <div class="modal-body flex-1 overflow-y-auto p-6">
                <!-- Obere Button-Leiste -->
                <div class="flex justify-between items-center mb-4 gap-2 flex-wrap">
                    <div class="flex gap-2 items-center flex-wrap">
                        <input type="text" id="database-search" placeholder="SPS Nummer oder Lieferant suchen..." class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 flex-1 min-w-[200px]">
                        <button id="add-profile-btn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors whitespace-nowrap">+ Neues Profil</button>
                        <button id="load-profile-btn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors whitespace-nowrap">Profil laden</button>
                    </div>
                    <div class="flex gap-2 flex-wrap">
                        <button id="open-database-btn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors whitespace-nowrap">üìÇ √ñffnen</button>
                        <button id="save-database-btn" class="px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors whitespace-nowrap">üíæ Speichern</button>
                        <button id="clear-last-database-btn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors whitespace-nowrap">üóëÔ∏è L√∂schen</button>
                    </div>
                </div>
                
                <!-- Datei-Info -->
                <div class="px-3 py-2 bg-gray-50 rounded mb-4 text-sm text-gray-600">
                    <span id="database-file-info">Keine Datei geladen</span>
                </div>
                
                <input type="file" id="database-file-input" accept=".json" class="hidden">
                <div class="border border-gray-200 rounded-lg overflow-hidden max-h-[500px] overflow-y-auto">
                    <table id="database-table" class="w-full border-collapse text-xs bg-white">
                        <thead class="bg-gray-200 sticky top-0">
                            <tr>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">ID</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">SPS Nummer</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">Lieferant</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">Lieferant Nummer</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">H√∂he (mm)</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">Material</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">Projekt</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">Skizze</th>
                                <th class="px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b-2 border-gray-300">Aktion</th>
                            </tr>
                        </thead>
                        <tbody id="database-tbody" class="bg-white">
                            <!-- Wird dynamisch gef√ºllt -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t border-gray-200">
                <button id="database-save" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors" title="Speichern">üíæ</button>
                <button id="database-cancel" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" title="Schlie√üen">‚úï</button>
            </div>
        </div>
    </div>

    <!-- Versionshinweis (wird automatisch aktualisiert) -->
    <div id="version-info" class="fixed bottom-2.5 left-2.5 text-xs text-gray-600 z-[1000] bg-white/80 backdrop-blur-sm px-2.5 py-1.5 rounded">
        Version 1.2.2
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg2pdf.js/1.4.1/svg2pdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
